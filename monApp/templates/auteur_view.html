{% extends 'base.html' %}

{% block main %}
<h1 class="mb-4">Consultation de l'auteur</h1>

<div class="card shadow-lg p-4">
  <h2 class="card-title mb-3 d-flex align-items-center">
    {{ selectedAuteur.Nom }}
  </h2>

  <!-- Liste des livres √©crits par l'auteur -->
  <h4 class="mt-4">Livres √©crits par cet auteur</h4>

  {% if selectedAuteur.livres.count() == 0 %}
    <p class="text-muted">Aucun livre trouv√© pour cet auteur.</p>
  {% else %}
    <div class="row">
      {% for livre in selectedAuteur.livres %}
        <div class="col-md-4 mb-4 d-flex">
          <div class="card shadow-sm flex-fill text-center p-3 position-relative"
               style="cursor: pointer;">
            
            <!-- Image -->
            <img src="{{ url_for('static', filename='images/' + livre.img) }}"
                 class="card-img-top mx-auto"
                 alt="{{ livre.titre }}"
                 style="height:220px; width:auto; object-fit:contain;">

            <!-- Contenu -->
            <div class="card-body d-flex flex-column">
              <h6 class="card-title text-truncate">{{ livre.titre }}</h6>
              <p class="mb-1">‚úçÔ∏è {{ livre.auteur.Nom }}</p>
              <p class="fw-bold text-danger">üí∞ {{ "%.2f"|format(livre.prix) }} ‚Ç¨</p>

              {% if livre.url %}
                <a href="{{ livre.url }}" target="_blank" 
                   class="btn btn-success w-100 mt-auto position-relative"
                   style="z-index: 10;">
                  Acheter
                </a>
              {% endif %}
            </div>

            <!-- Lien invisible qui rend toute la carte cliquable -->
            <a href="{{ url_for('viewLivre', idL=livre.idL) }}" 
               class="stretched-link"></a>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Bouton retour -->
  <div class="mt-3">
    <a href="{{ url_for('getAuteurs') }}" class="btn btn-secondary">Retour</a>
    {% if current_user.is_authenticated %}
    <a href="{{ url_for('updateAuteur', idA=selectedAuteur.idA) }}" 
      class="btn btn-warning" 
      title="Modifier le nom">
      Modifier
    </a>
    {% endif %}
  </div>
</div>
{% endblock %}
